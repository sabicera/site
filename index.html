<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>
</head>
<style>
    #map { height: 100vh; }
    #search-container {
        position: absolute;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
        background: white;
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
    #search-box {
        border-radius: 10px;
        padding: 5px;
        width: 250px;
    }
    #search-button {
        border-radius: 10px;
        padding: 5px 10px;
        margin-left: 5px;
        cursor: pointer;
    }
</style>
<body>
    <div id="map"></div>
    <div id="search-container">
        <input type="text" id="search-box" placeholder="Enter city, port, airport, or country">
        <button id="search-button">Search</button>
    </div>

    <script>
        var map = L.map('map').setView([8.982893638782873, -79.52887261889941], 9);

        // Add a Carto tile layer to the map with English labels
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            maxZoom: 18
        }).addTo(map);

        var marker = L.marker([8.982893638782873, -79.52887261889941]).addTo(map);
        marker.bindPopup("<b>3 Guards on Standby</b><br>10 to EMB<b>4 to Fly</b><b>2 at hospital</b>").openPopup();

        var athens = L.marker([37.9838, 23.7275]).addTo(map)
        .bindPopup('Athens, Greece');

        var johannesburg = L.marker([-26.205386722281816, 28.026974908534832]).addTo(map)
        .bindPopup('Johannesburg, South Africa');

        // Add polylines connecting Panama to Athens and Johannesburg
        var latlngs1 = [
            [37.9838, 23.7275], // Athens
            [8.982893638782873, -79.52887261889941]  // Panama
        ];
        var latlngs2 = [
            [8.982893638782873, -79.52887261889941],  // Panama
            [-26.205386722281816, 28.026974908534832] // Johannesburg
        ];
        var polyline1 = L.polyline(latlngs1, {color: 'lightgreen'}).addTo(map);
        var polyline2 = L.polyline(latlngs2, {color: 'lightblue'}).addTo(map);

        // Fit the map view to show both polylines
        var allLatLngs = latlngs1.concat(latlngs2);
        var bounds = L.latLngBounds(allLatLngs);
        map.fitBounds(bounds);

        document.getElementById('search-button').addEventListener('click', function() {
            var query = document.getElementById('search-box').value;
            if (query) {
                fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${query}`)
                .then(response => response.json())
                .then(data => {
                    if (data.length > 0) {
                        var location = data[0];
                        map.setView([location.lat, location.lon], 10);
                        L.marker([location.lat, location.lon]).addTo(map)
                            .bindPopup(location.display_name)
                            .openPopup();
                    } else {
                        alert('Location not found');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
            }
        });
    </script>
</body>
</html>
