window.formatVesselNameWithLink = function(text) {
    if (!text) return text;
    const vesselNames = Object.keys(VESSEL_ID_DATABASE);
    vesselNames.sort((a, b) => b.length - a.length);
    let formattedText = text;
    const upperText = text.toUpperCase();
    for (const name of vesselNames) {
        const index = upperText.indexOf(name);
        if (index !== -1) {
            const shipId = VESSEL_ID_DATABASE[name];
            const url = `https://www.marinetraffic.com/en/ais/home/shipid:${shipId}/zoom:16`;
            const originalNameMatch = text.substr(index, name.length);
            const linkHtml = `<a href="${url}" target="_blank" class="vessel-link">${originalNameMatch}</a>`;
            return text.replace(originalNameMatch, linkHtml);
        }
    }
    return text;
};

const VESSEL_ID_DATABASE = {
    "MSC ZONDA III": "758102",
    "MSC PRETORIA II": "757962",
    "MSC AMALFI": "2956",
    "MSC VIGO": "758696",
    "ARTEMIS": "6291945",
    "MSC SAGITTA III": "713208",
    "MSC SIYA B": "5690755",
    "MSC LE HAVRE": "9426771",
    "MSC LORENZA": "8506286",
    "MSC BOSPHORUS": "419385",
    "MSC LEO VI": "410383",
    "MSC ILLINOIS VII": "2696",
    "MSC HORTENSE": "9780611",
    "MSC JULIA R": "756293",
    "MSC CASSANDRE": "7116780",
    "MSC MUGE": "9771135",
    "MSC MAGNUM VII": "143667",
    "MSC MICHELA": "4301900",
    "MSC GIULIA": "4378187",
    "MSC VAISHNAVI R": "756294",
    "MSC URSULA VI": "421362",
    "MSC TIANJIN": "690702",
    "MSC PETRA": "754910",
    "CAPE AKRITAS": "4115608",
    "MSC NAOMI": "3474037",
    "MSC VANESSA": "419688",
    "MSC WESER": "715830",
    "MSC BRANKA": "4069935",
    "MSC RONIT R": "757579",
    "MSC ATHOS": "214829",
    "MSC MALENA": "713237",
    "MSC EMILIA": "9931061",
    "MSC RESILIENT III": "123709",
    "MSC PHOENIX": "415822",
    "MSC ORSOLA": "8187738",
    "MSC ALANYA": "6857243",
    "MSC ROUEN": "9297663",
    "MSC RAVENNA": "758688",
    "MSC DAR ES SALAAM III": "359689",
    "MSC CAROLINA": "460808",
    "CAPE KORTIA": "4315791",
    "MSC STACEY": "9295174",
    "MSC EDNA": "9656297",
    "MSC NIGERIA": "9282323",
    "VALOR": "2634",
    "MSC YAMUNA VI": "728459",
    "MSC ARICA": "2545",
    "MSC CADIZ": "758693",
    "MSC CANDIDA": "7989605",
    "MSC DON GIOVANNI": "418956",
    "MSC VALENTINA": "7936336",
    "MSC NAIROBI X": "685186",
    "MSC YASHI B": "5284893",
    "MSC ALTAIR": "755632",
    "MSC ALDEBARAN III": "289611",
    "MSC SOFIA PAZ": "756207",
    "MSC AVNI": "5148203",
    "MSC BELMONTE III": "124523",
    "MSC PANTERA": "8908650",
    "MSC MADHU B": "5272845",
    "EPAMINONDAS": "227786",
    "GREENVILLE": "8884123",
    "MSC RAYSHMI": "6860862",
    "MSC BERANGERE": "7822204",
    "MSC UNITED VIII": "753666",
    "MSC DARWIN VI": "133378",
    "MSC ROCHELLE": "756328",
    "MSC LOME V": "688561",
    "MSC REGULUS": "464203",
    "MSC NADRIELY": "297367",
    "MSC ELODIE": "3308713",
    "MSC VIVIENNE": "7865833",
    "MSC KATYA R": "756298",
    "MSC SOTIRIA III": "685771",
    "CAPE TAINARO": "4301798",
    "MSC ROSE": "8355300",
    "MSC MARINA": "415653",
    "MSC RIDA VII": "756118",
    "MANZANILLO BRIDGE": "9188432",
    "KURE": "213582",
    "SANTA LORETTA": "152798",
    "MSC TOMOKO": "414194",
    "MSC ADELE": "9671531",
    "MSC NATASHA XIII": "725762",
    "MSC MELINE": "3494516",
    "MSC MARGARITA": "756292",
    "MSC BREMEN": "757775",
    "MSC FLORA": "9537377",
    "MSC VANCOUVER": "297856",
    "MSC THAIS": "8107520",
    "MSC SAMIA": "9943272",
    "KARLSKRONA": "300138",
    "MSC CHLOE": "3917423",
    "MSC MUMBAI VIII": "143590",
    "MSC OLIVIA": "9378417",
    "MSC CAROLE": "6766072",
    "MSC ANISHA R": "756297",
    "MSC HUSUM III": "757533",
    "MSC ASTRID III": "407348",
    "MSC KATRINA": "464957",
    "MSC DUBAI VII": "754102",
    "MSC CALAIS": "9636172",
    "MSC DAMLA": "412429",
    "MSC EVEREST VIII": "143838",
    "MSC JUSTICE VIII": "758252",
    "MSC SERENA": "9774846",
    "MSC TOPAZ": "199073",
    "MSC ARUSHI R": "756295",
    "MSC LEILA": "9441641",
    "MSC DAKAR X": "8984989",
    "MSC JASPER VII": "758255",
    "MSC NICOLE X": "9214898",
    "MSC ELENOIRE": "9962603",
    "EUROPE": "144594",
    "EUROPE": "144594",

    "MSC PINA": "463965",
    "MSC ATHENS": "214826",
    "MSC JAPAN III": "460736",
    "MSC SUAPE VII": "133878",
    "MSC DOMITILLE": "3579312",
    "MSC ELIANA": "9818282",
    "MSC SHUBA B": "5096617",
    "MSC INSA": "9495123",
    "MSC SOLA": "459583",
    "MSC ANZU": "3573660",
    "MSC LOS ANGELES": "730617",
    "MSC NOA ARIELA": "7746268",
    "CAPE SOUNIO": "4653483",
    "MSC CANBERRA III": "420829",
    "MSC BRASILIA VII": "133872",
    "MSC ACCRA IV": "758215",
    "CATHERINE C": "8676359",
    "MSC VIDISHA R": "756300",
    "MSC JULIANA III": "757308",
    "MSC ELISABETTA": "9342816",
    "MSC ADONIS": "3603412",
    "MSC EXPRESS III": "1242848",
    "MSC MARIANNA": "409503",
    "MSC TIANSHAN": "152807",
    "MSC PASSION III": "758077",
    "MSC SASHA": "4330092",
    "MSC NERISSA V": "410823",
    "MSC MIRELLA R": "758132",
    "VALUE": "2657",
    "MSC ELOISE": "459901",
    "MSC EUGENIA": "7029539",
    "MSC MANYA": "755323",
    "MSC SUAPE VII": "133878",
    "MSC MARIA CLARA": "714770",
};
